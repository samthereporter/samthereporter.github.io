<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulation</title>
    <style>
        /* BASE STYLES - STARK & COLD */
        body {
            background-color: #f0f2f5;
            font-family: 'Georgia', serif;
            color: #2c3e50;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
        }

        /* MAIN GAME CONTAINER */
        .game-container {
            background: white;
            width: 90%;
            max-width: 700px;
            padding: 40px;
            border: 1px solid #d1d9e6;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            border-radius: 4px;
        }

        /* STATS BAR */
        .stats-bar {
            display: flex;
            justify-content: space-between;
            border-bottom: 2px solid #eee;
            padding-bottom: 15px;
            margin-bottom: 25px;
            font-family: sans-serif;
            font-size: 0.85rem;
            color: #555;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .stat-value {
            font-weight: bold;
            color: #2c3e50;
        }

        /* NARRATIVE TEXT */
        .story-text {
            font-size: 1.15rem;
            line-height: 1.7;
            margin-bottom: 30px;
            min-height: 150px;
        }

        /* CHOICES */
        .choices-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .choice-btn {
            background-color: transparent;
            border: 1px solid #2c3e50;
            color: #2c3e50;
            padding: 15px 20px;
            text-align: left;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.2s;
            font-family: sans-serif;
        }

        .choice-btn:hover {
            background-color: #2c3e50;
            color: white;
        }

        /* RESTART BUTTON (Hidden by default) */
        .restart-btn {
            margin-top: 20px;
            text-align: center;
            display: none;
            color: #888;
            cursor: pointer;
            text-decoration: underline;
        }

    </style>
</head>
<body>

    <div class="game-container">
        <div class="stats-bar">
            <span>Hunger: <span id="hunger-stat" class="stat-value">50%</span></span>
            <span>Warmth: <span id="warmth-stat" class="stat-value">100%</span></span>
            <span>Spirit: <span id="spirit-stat" class="stat-value">100%</span></span>
        </div>

        <div id="story-text" class="story-text">
            Loading...
        </div>

        <div id="choices" class="choices-container">
            </div>

        <div id="restart" class="restart-btn" onclick="startGame()">Restart Simulation</div>
    </div>

    <script>
        // --- GAME STATE ---
        let state = {
            hunger: 50, // Starts at 50 because poverty/food scarcity was common 
            warmth: 100,
            spirit: 100,
            name: localStorage.getItem('playerName') || "Student"
        };

        // --- THE STORY DATA (EDIT THIS SECTION) ---
        // Format: "scene_id": { text: "...", choices: [...] }
        const storyData = {
            
            // SCENE 1: THE ROAD ALLOWANCE
            "start": {
                text: `The morning air is biting cold. You wake up in your family's small home on the Road Allowance. It is technically not your landâ€”government officials call your family "squatters"[cite: 396]. <br><br>The house is drafty. Your grandmother is already awake, warming a small pot of tea. You know there is a long walk ahead of you. The school is miles away through the bush[cite: 400], and if you are late, the doors might be locked.`,
                choices: [
                    {
                        text: "Leave immediately to avoid being locked out.",
                        nextScene: "the_walk_rushed",
                        effects: { hunger: 10, warmth: 0, spirit: 0 } 
                        // Effect: Hunger increases (+10) because you skipped breakfast.
                    },
                    {
                        text: "Stay to eat some bannock, risking lateness.",
                        nextScene: "the_walk_fed",
                        effects: { hunger: -20, warmth: 0, spirit: 5 }
                        // Effect: Hunger goes down (-20), Spirit goes up (+5) from family time.
                    },
                    {
                        text: "Speak to your grandmother in Michif before you go.",
                        nextScene: "grandmother_talk",
                        effects: { hunger: 5, warmth: 0, spirit: 15 }
                        // Effect: Spirit goes up significantly (+15), reinforcing culture.
                    }
                ]
            },

            // SCENE 2A: RUSHED WALK
            "the_walk_rushed": {
                text: `You step out into the winter dark. You are hungry, but fear pushes you forward. You have to walk three or four miles through the bush[cite: 400]. <br><br>The wind cuts through your coat. You can see the lights of the residential school in the distance. It looks like a fortress.`,
                choices: [
                    {
                        text: "Run to generate body heat.",
                        nextScene: "arrival_early",
                        effects: { hunger: 10, warmth: -10, spirit: 0 }
                    },
                    {
                        text: "Walk carefully to save energy.",
                        nextScene: "arrival_ontime",
                        effects: { hunger: 5, warmth: -30, spirit: 0 }
                    }
                ]
            },

            // SCENE 2B: FED WALK
            "the_walk_fed": {
                text: `The bannock sits heavy in your stomach, a rare comfort. But the sun is already rising higher. You are behind schedule. <br><br>You walk fast, your boots crunching on the snow. You worry about the "extern" door. Sometimes they lock it right at the bell, leaving children outside in the cold[cite: 400].`,
                choices: [
                    {
                        text: "Take a shortcut across the frozen lake (Dangerous).",
                        nextScene: "arrival_ontime",
                        effects: { hunger: 5, warmth: -20, spirit: 0 }
                    },
                    {
                        text: "Stick to the road (Safer but slower).",
                        nextScene: "arrival_late",
                        effects: { hunger: 5, warmth: -20, spirit: 0 }
                    }
                ]
            },

            // SCENE 2C: GRANDMOTHER TALK
            "grandmother_talk": {
                text: `Your grandmother touches your cheek. She whispers to you in Michif. It feels warm, like a secret fire. <br><br>But you know the rules. At the school, speaking this language is forbidden[cite: 70]. The punishment is severe. As you leave the house, you have to push the words deep down inside you so they don't slip out.`,
                choices: [
                    {
                        text: "Start the long walk to school.",
                        nextScene: "arrival_ontime",
                        effects: { hunger: 10, warmth: -20, spirit: 0 }
                    }
                ]
            },

            // SCENE 3: ARRIVAL (Placeholder for you to write)
            "arrival_ontime": {
                text: `You arrive just as the bell rings. The "Boarders" (resident students) are already inside, lined up. <br><br>You are an "Extern." You must wait by the side entrance. You can smell the breakfast from the dining hall, but you are not allowed in[cite: 401].`,
                choices: [
                    {
                        text: "Wait quietly in the line.",
                        nextScene: "start", // LOOP BACK FOR DEMO PURPOSES
                        effects: { hunger: 5, warmth: -10, spirit: -5 }
                    }
                ]
            },

            "arrival_late": {
                 text: `You pull on the handle. Locked. <br><br>You are too late. The nuns have locked the extern door. You have to knock and wait, shivering, hoping someone will let you in before you freeze. This is a common punishment for the day scholars[cite: 400].`,
                 choices: [
                    {
                        text: "Knock loudly.",
                        nextScene: "start", // LOOP BACK FOR DEMO PURPOSES
                        effects: { hunger: 5, warmth: -20, spirit: -10 }
                    }
                 ]
            }
        };

        // --- ENGINE FUNCTIONS (DO NOT TOUCH UNLESS YOU KNOW JS) ---
        function startGame() {
            // Reset Stats
            state.hunger = 50;
            state.warmth = 100;
            state.spirit = 100;
            updateStatsUI();
            
            // Load first scene
            showScene("start");
            
            // Hide restart button
            document.getElementById('restart').style.display = 'none';
        }

        function showScene(sceneId) {
            const scene = storyData[sceneId];
            if (!scene) {
                document.getElementById('story-text').innerHTML = "Error: Scene not found.";
                return;
            }

            // Update Text
            // We replace [Name] with the player's stored name if you want to use it
            let processedText = scene.text.replace("[Name]", state.name);
            document.getElementById('story-text').innerHTML = processedText;

            // Clear old choices
            const choicesDiv = document.getElementById('choices');
            choicesDiv.innerHTML = '';

            // Create new buttons
            scene.choices.forEach(choice => {
                const btn = document.createElement('button');
                btn.className = 'choice-btn';
                btn.innerText = choice.text;
                btn.onclick = () => makeChoice(choice);
                choicesDiv.appendChild(btn);
            });
        }

        function makeChoice(choice) {
            // 1. Apply Effects
            if (choice.effects) {
                state.hunger += (choice.effects.hunger || 0);
                state.warmth += (choice.effects.warmth || 0);
                state.spirit += (choice.effects.spirit || 0);
                
                // Clamp values between 0 and 100
                state.hunger = Math.max(0, Math.min(100, state.hunger));
                state.warmth = Math.max(0, Math.min(100, state.warmth));
                state.spirit = Math.max(0, Math.min(100, state.spirit));
                
                updateStatsUI();
            }

            // 2. Check for "Game Over" or Special Conditions
            // Example: If warmth hits 0, you freeze.
            if (state.warmth <= 0) {
                document.getElementById('story-text').innerHTML = "The cold is too much. You collapse in the snow before reaching the school doors. (Game Over)";
                document.getElementById('choices').innerHTML = '';
                document.getElementById('restart').style.display = 'block';
                return;
            }

            // 3. Move to next scene
            showScene(choice.nextScene);
        }

        function updateStatsUI() {
            document.getElementById('hunger-stat').innerText = state.hunger + "%";
            document.getElementById('warmth-stat').innerText = state.warmth + "%";
            document.getElementById('spirit-stat').innerText = state.spirit + "%";
        }

        // Initialize
        startGame();

    </script>
</body>
</html>